<!DOCTYPE html>
<html>
  <head>
    <title>Bootstrap 101 Template</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- Bootstrap -->
    <link rel="stylesheet" href="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/css/bootstrap.min.css">

    <!-- HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries -->
    <!-- WARNING: Respond.js doesn't work if you view the page via file:// -->
    <!--[if lt IE 9]>
      <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
      <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
    <![endif]-->
  </head>
  <body>
    <h1>Sorting Hat</h1>
    
    <div class="container">

        <div class="form">
            <input type="number" id="student_count">
            <button id="set_student_count">Set Student Count</button>
            <div id="count"></div>
            <input type="text" id="student_name">
            <button id="sort_student">Sort!</button>
            <div id="sorted_student"></div>
        </div>


        <div class="house col-md-2">
            Gryffindor
        </div>
        <div class="house col-md-2">
            Hufflepuff
        </div>
        <div class="house col-md-2">
            Ravenclaw
        </div>
        <div class="house col-md-2">
            Slytherin
        </div>
        <div class="house col-md-2">
            Dumbledore's Army
        </div>
    </div>
    <!-- jQuery (necessary for Bootstrap's JavaScript plugins) -->
    <script src="https://code.jquery.com/jquery.js"></script>
    <!-- Include all compiled plugins (below), or include individual files as needed -->
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.0.3/js/bootstrap.min.js"></script>

    <script>
        var houses = {
            "Gryffindor": [],
            "Slytherin": [],
            "Ravenclaw": [],
            "Hufflepuff": [],
            "Dumbledore's Army": []
        };

        HOUSE = {
                1: "Gryffindor",
                2: "Slytherin",
                3: "Ravenclaw",
                4: "Hufflepuff"
            }

        var studentCount = 0;
        var countIsOdd;
        var fourthOfStudents;

        // get count div
        var countDiv = document.getElementById("count");

        // get count button and create click event
        var countButton = document.getElementById("set_student_count");
        countButton.addEventListener("click", function() {
            // clear houses for new sorting!
            for (var i = 1; i <= 4; i++)
            {
                houses[HOUSE[i]] = [];
            }

            // get user input for count value
            var countValue = document.getElementById("student_count").value;
            if (!countValue || countValue == NaN)
            {
                countValue = 0;
            }
            // set new value for global studentCount based on input
            studentCount = countValue;

            // did user input odd number of students?
            countIsOdd = (studentCount % 2 != 0)
            fourthOfStudents = Math.floor(studentCount/4);

            // Display new value of studentCount in the div
            countDiv.innerHTML = "Count: " + studentCount;

            // reset student_count input field
            countValue.value = 0;

            if (studentCount > 0)
            {
                sortButton.disabled = false;
            }
        });

        // get sort button and create click event
        var sortButton = document.getElementById("sort_student");
        sortButton.addEventListener("click", function() {
            // get student name
            var studentName = document.getElementById("student_name").value
            var studentHouse = assignHouse(studentName);
            var sortedDiv = document.getElementById("sorted_student");
            sortedDiv.innerHTML = studentName + ": " + studentHouse + "!"

            // decrement student Count
            studentCount--;

            // update display of students left to sort
            countDiv.innerHTML = "Students to sort: " + studentCount;

            // Check if all students are sorted
            if (studentCount == 0)
            {
                // disable sort button when all students are sorted
                sortButton.disabled = true;
            }
        });

        

        function assignHouse(studentName)
        {
            // randomly assign student to a house
            houseNum = Math.floor((Math.random() * 4) + 1);
            // check if house is full, if so, try again!
            if (isFull(HOUSE[houseNum]))
                    {
                        assignHouse(studentName);
                    }
            else
            {
                switch (houseNum) 
                {
                    case 1: // Gryffindor
                        houses[HOUSE[1]].push(studentName);
                        break;
                    case 2: // Slytherin
                        houses[HOUSE[2]].push(studentName);
                        break;
                    case 3: // Ravenclaw
                        houses[HOUSE[3]].push(studentName);
                        break;
                    case 4: // Hufflepuff
                        houses[HOUSE[4]].push(studentName);
                        break;
                }
                console.log(HOUSE[houseNum] + ": " + houses[HOUSE[houseNum]]);
                // return name of house student was sorted into
                return HOUSE[houseNum];
            } 
        }

        function isFull(houseName)
        {
            if (houses[houseName].length >= fourthOfStudents)
            {
                // if odd number students, one house gets one more than others
                // update countIsOdd, so other houses don't get extra students
                if (countIsOdd)
                {
                    countIsOdd = false;
                    return false;
                }
                return true;
            }
            return false;
        }
    </script>

  </body>
</html>
